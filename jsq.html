
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ä¼ å¥‡BOSSè®¡æ—¶å™¨</title>
<meta name="keywords" content="ä¼ å¥‡BOSS, BOSSè®¡æ—¶å™¨, ä¼ å¥‡, æ¸¸æˆè®¡æ—¶å™¨, BOSSåˆ·æ–°æ—¶é—´, ä¼ å¥‡æ”»ç•¥, æ¸¸æˆå·¥å…·, BOSS, ä¼ å¥‡ä¸–ç•Œ, ä¼ å¥‡ç§æœ" />
<meta name="description" content="ç²¾å‡†æŒæ¡ä¼ å¥‡æ¸¸æˆä¸­çš„BOSSåˆ·æ–°æ—¶é—´ï¼ŒåŠ©ä½ è½»æ¾å‡»æ€ï¼æœ¬ç«™æä¾›ä¼ å¥‡BOSSè®¡æ—¶å™¨ï¼Œå®æ—¶è¿½è¸ªBOSSåˆ·æ–°çŠ¶æ€ï¼ŒåŠ©ä½ æŠ¢å…ˆä¸€æ­¥ï¼Œè·å–æå“è£…å¤‡ã€‚æ›´æœ‰ä¼ å¥‡æ”»ç•¥åˆ†äº«ï¼ŒåŠ©ä½ æˆä¸ºä¼ å¥‡ä¸–ç•Œçš„éœ¸ä¸»ï¼" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="stylesheet" href="./static/ruchu/mir.css">
 
<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: #f5f5f5;
    }
    .container {
        max-width: 700px;
        margin: 0 auto;
        margin-top: 20px;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
        flex-wrap: wrap;
        padding: 15px;
        background: #f0f8f0;
        border-radius: 8px;
    }
    .header-left {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
    }
    .header-right {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }
    .warning-time {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .warning-time label {
        color: #333;
        font-weight: bold;
    }
    .warning-time input {
        width: 60px;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
    }
    .font-size {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    /* åœ¨.font-sizeæ ·å¼å—ä¸‹æ–¹æ–°å¢ */
.countdown-sound {
display: flex;
align-items: center;
gap: 10px;
}
.countdown-sound label {
color: #333;
font-weight: bold;
}
    
    .font-size label {
        color: #333;
        font-weight: bold;
    }
    /* å­—ä½“å¤§å°ç±» - åº”ç”¨äºæ‰€æœ‰éœ€è¦è°ƒæ•´çš„å…ƒç´  */
    .default-font {
        font-size: 14px; /* é»˜è®¤å­—ä½“å¤§å° */
    }
    .medium-font {
        font-size: 16px; /* ä¸­ç­‰å­—ä½“å¤§å° */
    }
    .large-font {
        font-size: 18px; /* å¤§å­—ä½“å¤§å° */
    }
    .extra-large-font {
        font-size: 20px; /* ç‰¹å¤§å­—ä½“å¤§å° */
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        box-shadow: 0 1px 5px rgba(0,0,0,0.1);
    }
    th, td {
        padding: 8px 6px;
        text-align: left;
        border-bottom: 1px solid #e0e0e0;
        white-space: nowrap; /* é˜²æ­¢å†…å®¹æ¢è¡Œ */
    }
    th {
        background-color: #2E7D32;
        color: white;
        font-weight: bold;
        position: sticky;
        top: 0;
    }
    tr:nth-child(even) {
        background-color: #f9f9f9;
    }
    tr:hover {
        background-color: #f1f8e9;
    }
    input[type="checkbox"] {
        transform: scale(2);
        cursor: pointer;
    }
    input[type="number"] {
        width: 80px;
        padding: 5px;
        border: 1px solid #ddd;
        border-radius: 4px;
    }
    input[type="text"] {
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        width: 100%;
        box-sizing: border-box;
        font-size: 20px;
        font-weight: bold;
    }
    button {
        background-color: #2E7D32;
        color: white;
        padding: 10px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
        white-space: nowrap;
    }
    button:hover {
        background-color: #1B5E20;
        transform: translateY(-2px);
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .mute-btn {
        background-color: #f44336;
    }
    .unmute-btn {
        background-color: #4CAF50;
    }
    .countdown {
        color: #000000; /* é»˜è®¤é»‘è‰² */
        font-weight: bold;
        font-family: 'Digital-7', 'Courier New', monospace; /* ä½¿ç”¨æ›´å…·æ•°å­—æ„Ÿçš„å­—ä½“ */
        font-size: 2.2em; /* å¢å¤§å­—ä½“å¤§å° */
        text-shadow: 0 0 8px rgba(0, 0, 0, 0.7); /* æ·»åŠ å‘å…‰æ•ˆæœ */
        letter-spacing: 2px; /* å¢åŠ å­—æ¯é—´è· */
        animation: pulse 1.5s infinite alternate; /* æ·»åŠ è·³åŠ¨åŠ¨ç”» */
    }

    @keyframes pulse {
        from {
            transform: scale(1);
            opacity: 1;
        }
        to {
            transform: scale(1.05);
            opacity: 0.9;
        }
    }
    .time-input {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box;
        font-family: 'Courier New', monospace;
    }
    .time-input:focus {
        outline: none;
        border-color: #4CAF50;
        box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
    }
    .voice-status {
        margin: 10px 0;
        padding: 10px;
        background-color: #e8f5e9;
        border-radius: 6px;
        text-align: center;
        font-weight: bold;
        color: #2E7D32;
        border: 1px solid #c8e6c9;
    }
    .tip {
        padding: 10px;
        background-color: #fff8e1;
        border-radius: 6px;
        margin-bottom: 15px;
        border: 1px solid #ffecb3;
        color: #7d6608;
        font-weight: bold;
    }
    .footer {
        text-align: center;
        margin-top: 20px;
        color: #757575;
    }
    
    /* æ–°å¢é¢„è­¦æ ·å¼ */
    .warning-alert {
        background-color: yellow !important;
        color: red !important;
        font-weight: bold;
    }
    .warning-alert input,
    .warning-alert .countdown {
        color: red !important;
        font-weight: bold;
        background-color: #fff8e1 !important;
    }
    
/* åœ°å›¾ååˆ—å®½åº¦å¢å¤§ */
#bossTable tr td:nth-child(2) {
width: 15%; /* åœ°å›¾åå®½åº¦ */
padding-right: 1px;
}

/* é—´éš”åˆ—å®½åº¦å‡å° */
#bossTable tr td:nth-child(3) {
width: 1%; /* é—´éš”åˆ—å®½åº¦ï¼ˆå·²ç¼©å°ï¼‰ */
padding-right: 1px;
}

/* ä¸Šæ¬¡åˆ·æ–°æ—¶é—´åˆ—å®½åº¦å‡å° */
#bossTable tr td:nth-child(4) {
width: 5%; /* æ—¶é—´åˆ—å®½åº¦ */
}

/* ä¸‹æ¬¡åˆ·æ–°æ—¶é—´åˆ—å®½åº¦å‡å° */
#bossTable tr td:nth-child(5) {
width: 5%; /* æ—¶é—´åˆ—å®½åº¦ */
}

/* å€’è®¡æ—¶åˆ—å®½åº¦ */
#bossTable tr td:nth-child(6) {
width: 3%; /* å€’è®¡æ—¶åˆ—å®½åº¦ */
}

/* å¼€å…³åˆ—å®½åº¦ */
#bossTable tr td:nth-child(1) {
width: 2%; /* å¼€å…³åˆ—å®½åº¦ */
}
    
    @media (max-width: 768px) {
        .header {
            flex-direction: column;
            align-items: flex-start;
        }
        .header-right {
            width: 100%;
            justify-content: center;
        }
        th, td {
            padding: 10px 8px;
        }
    }
/* ä¿¡æ¯æç¤ºæ–‡æœ¬æ ·å¼ */
.info-text {
display: flex;
align-items: center;
gap: 8px;
color: #555;
font-size: 14px;
padding: 5px 10px;
border-left: 3px solid #4CAF50;
background-color: #f1f8e9;
border-radius: 0 4px 4px 0;
margin: 0 10px;
}

/* é“¾æ¥æ ·å¼ */
.info-link {
color: #2E7D32;
text-decoration: none;
font-weight: bold;
border-bottom: 1px dashed #2E7D32;
padding-bottom: 1px;
transition: all 0.2s;
}

.info-link:hover {
color: #1B5E20;
border-bottom-style: solid;
}

/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 768px) {
.info-text {
    font-size: 13px;
    margin: 10px 0;
    width: 100%;
    justify-content: center;
}
}
</style>
</head>
<body>
    <nav id=fpb-c28 class="navbar navbar-expand-md sticky-top"><a id=fpb-c28 class="navbar-brand" href="http://176170.xyz/">ä¼ å¥‡è¡¥ä¸</a>
        <button id=fpb-c28 type="button" class="navbar-toggler navbar-dark"><span id=fpb-c28 class="navbar-toggler-icon"></span></button>
        <div class="navbar-collapse collapse">
    <!--    <div id=fpb-c28 class="pl-3">
          <a id=fpb-c28 class="dropdown-item" href="./">é¦–é¡µ</a>
          </div>-->
          <ul class="navbar-nav mr-auto">
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">ç³»ç»Ÿ</a>
              <ul id=fpb-c28 class="dropdown-menu">
                <li><a id=fpb-c28 class="dropdown-item" href="content_7.html">ç•Œé¢</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_2.html">çƒ­é”®</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_6.html">å‘½ä»¤</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_3.html">å±æ€§ä¸­è‹±å¯¹ç…§</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="./">ç»éªŒåˆ—è¡¨</a></li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">å±æ€§è¡¨</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="content_5.html">æˆ˜å£«å±æ€§è¡¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="content_4.html">æ³•å¸ˆå±æ€§è¡¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="content_8.html">é“å£«å±æ€§è¡¨</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">åœ°å›¾</a>
              <ul id=fpb-c28 class="dropdown-menu">
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ¯”å¥‡åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Map.html">æ¯”å¥‡çœ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList.html">å…½äººå¤å¢“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_2.html">å¤©ç„¶æ´ç©´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_3.html">æ¯”å¥‡çŸ¿åŒº</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ²ƒç›åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Map_2.html">æ²ƒç›æ£®æ—</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_4.html">æ²ƒç›è‡ªç„¶æ´ç©´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_5.html">æ²ƒç›å¯ºåº™</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ¯’è›‡åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Map_3.html">æ¯’è›‡å±±è°·</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_6.html">æ¯’è›‡çŸ¿åŒº</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">ç›Ÿé‡åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Map_4.html">ç›Ÿé‡çœ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_7.html">èœˆèš£æ´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_8.html">æœªçŸ¥æš—æ®¿</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_9.html">çŸ³å¢“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_10.html">é¦™çŸ³å¤å¢“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_11.html">ç¥–ç›å¯ºåº™</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Map_5.html">æ²™å·´å…‹å¯†é“</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">ç™½æ—¥é—¨åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Map_6.html">ç™½æ—¥é—¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Map_7.html">ä¸›æ—è¿·å®«</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_12.html">èµ¤æœˆå³¡è°·</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">å°é­”è°·åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Map_8.html">å°é­”è°·</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_13.html">å°é­”æ®¿</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">è‹æœˆåœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Map_9.html">è‹æœˆå²›</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_14.html">å°¸é­”æ´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_15.html">éª¨é­”æ´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_16.html">ç‰›é­”å¯ºåº™</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">å…¶ä»–åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="MapList_17.html">å…­ä»¶æ–°è¡£</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">æ€ªç‰©</a>
              <ul id=fpb-c28 class="dropdown-menu">
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ¯”å¥‡åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster.html">æ¯”å¥‡çœ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_2.html">å…½äººå¤å¢“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_3.html">å¤©ç„¶æ´ç©´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_5.html">æ¯”å¥‡çŸ¿åŒº</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ²ƒç›åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_4.html">æ²ƒç›æ£®æ—</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_6.html">æ²ƒç›è‡ªç„¶æ´ç©´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_8.html">æ²ƒç›å¯ºåº™</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ¯’è›‡åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_7.html">æ¯’è›‡å±±è°·</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_9.html">æ¯’è›‡çŸ¿åŒº</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">ç›Ÿé‡åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_16.html">ç›Ÿé‡çœ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_10.html">èœˆèš£æ´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_11.html">æœªçŸ¥æš—æ®¿</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_12.html">çŸ³å¢“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_13.html">é¦™çŸ³å¤å¢“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_14.html">ç¥–ç›å¯ºåº™</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_15.html">æ²™å·´å…‹å¯†é“</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">ç™½æ—¥é—¨åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_18.html">ç™½æ—¥é—¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_17.html">ä¸›æ—è¿·å®«</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_19.html">èµ¤æœˆå³¡è°·</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">å°é­”åœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_20.html">å°é­”è°·</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_21.html">å°é­”æ®¿</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">è‹æœˆåœ°åŒº</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_22.html">è‹æœˆå²›</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_23.html">å°¸é­”æ´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_24.html">éª¨é­”æ´</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Monster_25.html">ç‰›é­”å¯ºåº™</a></li>
                  </ul>
                </li>
                <li><a id=fpb-c28 class="dropdown-item" href="Monster_26.html">BOSS</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="Monster_28.html">ç”Ÿç‰©ç³»</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="Monster_27.html">ä¸æ­»ç³»</a></li>
              </ul>
            </li>
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">ç‰©å“</a>
              <ul id=fpb-c28 class="dropdown-menu">
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ­¦å™¨</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Item.html">é€šç”¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_2.html">æˆ˜å£«</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_3.html">æ³•å¸ˆ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_4.html">é“å£«</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">ç›”ç”²</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_5.html">é€šç”¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_6.html">æˆ˜å£«</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_7.html">æ³•å¸ˆ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_8.html">é“å£«</a></li>
                  </ul>
                </li>
                <li><a id=fpb-c28 routerlink="list/7" class="dropdown-item" href="Item_9.html">å¤´ç›”</a></li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">é¡¹é“¾</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_10.html">é€šç”¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_11.html">æˆ˜å£«</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_12.html">æ³•å¸ˆ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_13.html">é“å£«</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ‰‹é•¯</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_14.html">é€šç”¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_15.html">æˆ˜å£«</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_17.html">æ³•å¸ˆ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_16.html">é“å£«</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æˆ’æŒ‡</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_18.html">é€šç”¨</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_19.html">æˆ˜å£«</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_20.html">æ³•å¸ˆ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_21.html">é“å£«</a></li>
                  </ul>
                </li>
                <li><a id=fpb-c28 class="dropdown-item" href="Suit.html">å¥—è£…</a></li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æ¶ˆè€—å“</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_22.html">æ¢å¤æ¶ˆè€—å“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_23.html">å¢å¼ºæ¶ˆè€—å“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_24.html">ç‰¹æ®Šæ¶ˆè€—å“</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_26.html">çŸ¿çŸ³</a></li>
                  </ul>
                </li>
                <li id=fpb-c28 class="dropright dropdown-submenu"><a id=fpb-c28 class="dropdown-item dropdown-toggle">æŠ€èƒ½ä¹¦</a>
                  <ul id=fpb-c28 class="dropdown-menu">
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_25.html">æˆ˜å£«</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_27.html">æ³•å¸ˆ</a></li>
                    <li><a id=fpb-c28 class="dropdown-item" href="Item_28.html">é“å£«</a></li>
                  </ul>
                </li>
                
              </ul>
            </li>
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">åˆæˆ</a>
              <ul id=fpb-c28 class="dropdown-menu">
                <li><a id=fpb-c28 routerlink="list/170" class="dropdown-item" href="Merge.html">ææ–™&amp;æ¶ˆè€—å“</a></li>
              </ul>
            </li>
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">æŠ€èƒ½</a>
              <ul id=fpb-c28 class="dropdown-menu">
                <li><a id=fpb-c28 class="dropdown-item" href="Magic.html">æˆ˜å£«æŠ€èƒ½</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="Magic_2.html">æ³•å¸ˆæŠ€èƒ½</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="Magic_3.html">é“å£«æŠ€èƒ½</a></li>
              </ul>
            </li>
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">ä»»åŠ¡</a>
              <ul id=fpb-c28 class="dropdown-menu">
                <li><a id=fpb-c28 class="dropdown-item" href="content_9.html">ç¥ˆç¦é¡¹é“¾ä»»åŠ¡</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_10.html">åˆçº§è£…å¤‡ä»»åŠ¡</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_11.html">ä¼ è¯´ä¸­çš„ç½—åˆ¹ä»»åŠ¡</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_12.html">æŠ€å·§é¡¹é“¾ä»»åŠ¡</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_13.html">tsjzyst</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_14.html">ç¥ç§˜å•†åº—ä»»åŠ¡</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_15.html">æ”»å‡»ç¥æ°´é‡‘ç –</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_16.html">å‘½è¿ä¹‹åˆƒä»»åŠ¡</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_17.html">ç ´é¦†çå‰‘ä»»åŠ¡</a></li>
              </ul>
            </li>
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">çˆ†ç‡</a>
              <ul id=fpb-c28 class="dropdown-menu">
              <li><a id=fpb-c28 class="dropdown-item" href="stditem.html">ç‰©å“æŸ¥è¯¢</a></li>
              <li><a id=fpb-c28 class="dropdown-item" href="guaiwu.html">æ€ªç‰©æŸ¥è¯¢</a></li>
              <li><a id=fpb-c28 class="dropdown-item" href="map.html">åœ°å›¾æŸ¥è¯¢</a></li>
              <li><a id=fpb-c28 class="dropdown-item" href="npc.html">NPCæŸ¥è¯¢</a></li>
     <!--             <li><a id=fpb-c28 class="dropdown-item" href="content.aspx">ç‚«å½©ã€ç‚«é…·æŠ€èƒ½</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content.aspx">æ¶ˆé™¤ç¥å…½å–·æ€ªå£°</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content.aspx">è¿·ä½ ç¥å…½</a></li>-->
              </ul>
            </li>
            <li id=fpb-c28 class="nav-item dropdown"><a id=fpb-c28 class="nav-link dropdown-toggle">èµ„æ–™</a>
              <ul id=fpb-c28 class="dropdown-menu">
            	<li><a class="dropdown-item" href="https://pdfyl.ertongbook.com/68/33840937.pdf" target="_blank">åŸç‰ˆçƒ­è¡€ä¼ å¥‡å…¨æ”»ç•¥.pdf</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_18.html">èœˆèš£æ´èµ°æ³•ä¼ é€å›¾</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_19.html">ç¥–ç›é˜æ€ä¹ˆèµ°å›¾è§£</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_20.html">çŸ³å¢“é˜µèµ°æ³•å›¾è§£</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_21.html">å¹»å¢ƒè¿·å®«èµ°æ³•å›¾è§£</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_22.html">åœ£åŸŸèµ°æ³•å›¾è§£</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_23.html">èµ¤æœˆèµ°æ³•ä¼ é€å›¾</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_24.html">æ²™å·´å…‹ç§˜å¯†é€šé“èµ°æ³•</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_25.html">é“å£«3ã€4çº§æ¯’ä¼¤å®³</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_26.html">æŠ€èƒ½ç­‰çº§å¯¹ç…§è¡¨</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_27.html">æ³•å¸ˆå®å®å±æ€§è¡¨</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_28.html">é“å£«éª·é«…ç¥å…½å±æ€§</a></li>
                <li><a id=fpb-c28 class="dropdown-item" href="content_29.html">ä¼ å¥‡æ€ªç‰©å±æ€§è¡¨</a></li>
              </ul>
            </li>
     
            <li>
                <a class="nav-link" href="jsq.html">è®¡æ—¶å™¨</a>
            </li>
        </ul>
         

          
    <!--      <div id=fpb-c28 class="mr-auto pl-3 py-2">
          <select _ngcontent-hwb-c28="" aria-label="Language Selecter"><option _ngcontent-hwb-c28="" value="CN">CN</option><option _ngcontent-hwb-c28="" value="EN">EN</option></select>
          </div>-->
        </div>
      </nav>
<div style="width: 100%; display: flex; justify-content: center; align-items: center; padding: 10px 0;">
    <a href="./daohang.html" target="_blank" class="text-decoration-none ad-link">
        <img src="files/dh.gif" alt="µ¼º½¹ã¸æ" style="
            display: block;
            max-width: 100%;
            height: auto;
            object-fit: cover; /* Æ½ÆÌÏÔÊ¾£¬±£³Ö±ÈÀı²¢¸²¸ÇÈİÆ÷ */
            border-radius: 12px; /* Ô²½Ç´óĞ¡£¬¿É×ÔĞĞµ÷Õû */
            width: 100%; /* Æ½ÆÌÕ¼Âú¸¸ÈİÆ÷¿í¶È */
            max-height: 100%;
        ">
    </a>
</div>
 <div class="container">
        <div class="tip default-font">å‹æƒ…æç¤º: è¯·å‹¿å°†æœ¬é¡µé¢è¦†ç›–ï¼å¦åˆ™ä¼šå‡ºç°è®¡æ—¶æ··ä¹±ï¼</div>
 

        <table id="bossTable">
            <thead>
                <tr>
                    <th class="default-font">å¼€å…³</th>
                    <th class="default-font">åœ°å›¾å</th>
                    <th class="default-font">é—´éš”(ç§’)</th>
                    <th class="default-font">ä¸Šæ¬¡åˆ·æ–°æ—¶é—´</th>
                    <th class="default-font">ä¸‹æ¬¡åˆ·æ–°æ—¶é—´</th>
                    <th class="default-font">å€’è®¡æ—¶</th>
                </tr>
            </thead>
            <tbody>
                <!-- è¡Œå°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </tbody>
        </table>
                
        <div class="header">
            <div class="header-left">
                <div class="warning-time">
                    <label class="default-font">é¢„è­¦æ—¶é—´(ç§’):</label>
                    <input type="number" id="warningTime" value="30" min="0" max="300" class="default-font">
                </div>
                <div class="font-size">
                    <label class="default-font">å­—ä½“å¤§å°:</label>
                    <select id="fontSize" onchange="changeFontSize(this.value)" class="default-font">
                        <option value="default">é»˜è®¤</option>
                        <option value="medium">ä¸­</option>
                        <option value="large">å¤§</option>
                        <option value="large">ç‰¹å¤§</option>
                    </select>
                </div>
        <div class="countdown-sound">
      <label class="default-font">ç¦æ­¢æ•°å­—è¯­éŸ³:</label>
      <input type="checkbox" id="disableCountdownSound" class="default-font" checked>
    </div>
 
    <div class="info-text">
    <i class="fa fa-lightbulb-o"></i> 
    
    <span>æ‰€æœ‰BOSSåˆ·æ–°æ—¶é—´<a href="./shijian.html" target="_blank" class="info-link">ç‚¹å‡»æŸ¥çœ‹</a></span>
    
     
</div>


            </div>
            <div class="header-right">
                <button class="default-font" onclick="addRow()">æ–°å¢è¡Œ</button>
                <button class="default-font" onclick="deleteLastRow()">åˆ é™¤æœ€åä¸€è¡Œ</button>
                <button class="default-font" onclick="exportConfig()">å¯¼å‡ºé…ç½®</button>
                <button class="default-font" onclick="importConfig()">å¯¼å…¥é…ç½®</button>
                <button id="muteBtn" class="unmute-btn default-font" onclick="toggleMute()">é™éŸ³æ¨¡å¼</button>
            </div>
        </div>
        <div class="footer default-font">
            <p>ä¼ å¥‡BOSSè®¡æ—¶å™¨ &copy; 2023 - ç²¾å‡†æŒæ¡BOSSåˆ·æ–°æ—¶é—´</p>
        </div>
    </div>
 </boby>
    <script>
// å…¨å±€å˜é‡
let activeTimers = new Set();
let isMuted = localStorage.getItem('isMuted') === 'true';
let lastPlayedSecondsMap = new Map();
let disableCountdownSound = localStorage.getItem('disableCountdownSound') === 'true';
let isPageActive = true;
let lastActiveTime = new Date();
let audioContext = null; // éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼Œç”¨äºç»´æŒéŸ³é¢‘æ’­æ”¾èƒ½åŠ›
let audioBuffers = new Map(); // ç¼“å­˜éŸ³é¢‘ç¼“å†²åŒº
let isAudioInitialized = false; // éŸ³é¢‘ç³»ç»Ÿæ˜¯å¦åˆå§‹åŒ–
let playingAudio = new Map(); // è·Ÿè¸ªå½“å‰æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘ï¼Œé˜²æ­¢é‡å¤æ’­æ”¾

// æœ¬åœ°å­˜å‚¨é”®å
const STORAGE_KEY = 'bossTimerData';

// ç™¾åº¦è¯­éŸ³APIåŸºç¡€URL
const BAIDU_TTS_BASE_URL = 'http://tsn.baidu.com/text2audio';

// APIå‚æ•°é…ç½®
const API_PARAMS = {
    lan: 'zh',
    ctp: 1,
    cuid: 'abcdxxx',
    tok: '25.3925fe5df4c41f88effa9e3db51e5867.315360000.1879070368.282335-16414820',
    vol: 9,
    spd: 5,
    pit: 5,
    aue: 3
};

// åˆå§‹åŒ–å‡½æ•°
function initialize() {
    // è®¾ç½®é™éŸ³æŒ‰é’®çŠ¶æ€
    updateMuteButton();
    
    // åˆ›å»ºé»˜è®¤çš„10è¡Œæ•°æ®
    createDefaultRows();
    
    // åŠ è½½å­˜å‚¨çš„æ•°æ®
    loadFromStorage();
    
    // åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡
    initAudioContext();
    
    // è®¾ç½®å®šæ—¶å™¨
    setInterval(updateAllCountdowns, 1000);
    setInterval(saveToStorage, 300000); // 5åˆ†é’Ÿè‡ªåŠ¨ä¿å­˜
   //  setInterval(correctTimeDrift, 60000); // 1åˆ†é’Ÿæ—¶é—´æ ¡æ­£
    // setInterval(keepAudioAlive, 30000); // æ¯30ç§’æ¿€æ´»ä¸€æ¬¡éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼Œé˜²æ­¢è¢«æµè§ˆå™¨æš‚åœ
    
    // è®¾ç½®é»˜è®¤å­—ä½“å¤§å°
    changeFontSize(document.getElementById('fontSize').value);
    
    // ä¸ºç¦æ­¢å€’è®¡æ—¶éŸ³æ•ˆé€‰æ‹©æ¡†æ·»åŠ äº‹ä»¶ç›‘å¬
    document.getElementById('disableCountdownSound').addEventListener('change', function() {
        disableCountdownSound = this.checked;
        localStorage.setItem('disableCountdownSound', disableCountdownSound);
    });
    
    // ç›‘å¬é¡µé¢ç„¦ç‚¹äº‹ä»¶
    document.addEventListener('visibilitychange', handleVisibilityChange);
    
    // æ·»åŠ ç”¨æˆ·äº¤äº’ç›‘å¬ï¼Œç”¨äºæ¿€æ´»éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼ˆæµè§ˆå™¨å®‰å…¨ç­–ç•¥è¦æ±‚ï¼‰
    document.addEventListener('click', initAudioOnInteraction);
    document.addEventListener('touchstart', initAudioOnInteraction);

    // åˆå§‹åŒ–é¡µé¢æ´»åŠ¨çŠ¶æ€
    isPageActive = !document.hidden;
}

// åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡
function initAudioContext() {
    try {
        window.AudioContext = window.AudioContext || window.webkitAudioContext;
        if (window.AudioContext) {
            audioContext = new AudioContext();
            // é¢„åŠ è½½æ•°å­—éŸ³é¢‘
            [1, 2, 3, 4, 5].forEach(num => {
                loadAudioBuffer(`mp3/${num}.mp3`, num);
            });
            loadAudioBuffer('mp3/yj.mp3', 'warning');
            isAudioInitialized = true;
        }
    } catch (e) {
        console.error('æ— æ³•åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡:', e);
        isAudioInitialized = false;
    }
}

// å½“ç”¨æˆ·ä¸é¡µé¢äº¤äº’æ—¶åˆå§‹åŒ–éŸ³é¢‘ï¼ˆè§£å†³æµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾é™åˆ¶ï¼‰
function initAudioOnInteraction() {
    if (!isAudioInitialized) {
        initAudioContext();
        // æ’­æ”¾ä¸€æ®µæ— å£°éŸ³é¢‘æ¥æ¿€æ´»éŸ³é¢‘ä¸Šä¸‹æ–‡
        playSilentAudio();
        // ç§»é™¤äº‹ä»¶ç›‘å¬ï¼Œé¿å…é‡å¤è§¦å‘
        document.removeEventListener('click', initAudioOnInteraction);
        document.removeEventListener('touchstart', initAudioOnInteraction);
    }
}

// åŠ è½½éŸ³é¢‘æ–‡ä»¶åˆ°ç¼“å†²åŒº
function loadAudioBuffer(url, key) {
    if (!audioContext) return;
    
    fetch(url)
        .then(response => response.arrayBuffer())
        .then(arrayBuffer => audioContext.decodeAudioData(arrayBuffer))
        .then(audioBuffer => {
            audioBuffers.set(key, audioBuffer);
        })
        .catch(error => {
            console.error(`åŠ è½½éŸ³é¢‘ ${url} å¤±è´¥:`, error);
        });
}

// æ’­æ”¾ç¼“å†²åŒºä¸­çš„éŸ³é¢‘
function playBuffer(key) {
    if (isMuted || !audioContext || !audioBuffers.has(key)) return;

    // å¦‚æœè¯¥éŸ³é¢‘æ­£åœ¨æ’­æ”¾ï¼Œåˆ™ä¸é‡å¤æ’­æ”¾
    if (playingAudio.has(key)) {
        return;
    }
    
    // ç¡®ä¿éŸ³é¢‘ä¸Šä¸‹æ–‡å¤„äºè¿è¡ŒçŠ¶æ€
    if (audioContext.state === 'suspended') {
        audioContext.resume();
    }
    
    const source = audioContext.createBufferSource();
    source.buffer = audioBuffers.get(key);
    source.connect(audioContext.destination);
    source.start(0);

    // æ ‡è®°ä¸ºæ­£åœ¨æ’­æ”¾
    playingAudio.set(key, source);

    // æ’­æ”¾ç»“æŸåä» playingAudio ä¸­ç§»é™¤
    source.onended = () => {
        playingAudio.delete(key);
    };
}

// æ’­æ”¾ä¸€æ®µæ— å£°éŸ³é¢‘ï¼Œç”¨äºæ¿€æ´»éŸ³é¢‘ä¸Šä¸‹æ–‡
function playSilentAudio() {
    if (!audioContext) return;
    
    const source = audioContext.createBufferSource();
    const buffer = audioContext.createBuffer(1, 1, 22050);
    source.buffer = buffer;
    source.connect(audioContext.destination);
    source.start(0);
}

// å®šæœŸæ¿€æ´»éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼Œé˜²æ­¢è¢«æµè§ˆå™¨æš‚åœ
function keepAudioAlive() {
    if (audioContext && audioContext.state === 'running' && !isMuted) {
        playSilentAudio();
    }
}

// å¤„ç†é¡µé¢å¯è§æ€§å˜åŒ–
function handleVisibilityChange() {
    if (document.hidden) {
        isPageActive = false;
    } else {
        isPageActive = true;
        // å½“é¡µé¢è·å¾—ç„¦ç‚¹æ—¶ï¼Œå¼ºåˆ¶æ›´æ–°æ‰€æœ‰å€’è®¡æ—¶ï¼Œä»¥åŒæ­¥çŠ¶æ€
        updateAllCountdowns(true); 
    }
}

// åˆ›å»ºé»˜è®¤çš„10è¡Œæ•°æ®
function createDefaultRows() {
    const tbody = document.querySelector('#bossTable tbody');
    tbody.innerHTML = '';
    lastPlayedSecondsMap.clear(); // æ¸…ç©ºMap
    
    const maps = [
        "å°é­”æ®¿æå“", "é›·éœ†ç™½çŒª", "éœ¸è€…å¤§å…", "èµ¤æœˆå·¢ç©´", "å°¸ç‹æ®¿",
        "æ²ƒç›æ•™ä¸»", "ç¥–ç›æ•™ä¸»", "ç‰›é­”å¤§å…", "çŸ³å¢“é˜µ", "æœªçŸ¥æš—æ®¿"
    ];
    
    for (let i = 0; i < 10; i++) {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><input type="checkbox" onchange="handleCheckbox(this)" class="default-font"></td>
            <td><input type="text" value="${maps[i] || `BOSS${i+1}`}" class="default-font"></td>
            <td><input type="number" value="1200" class="default-font"></td>
            <td><input type="text" class="time-input default-font" value="--:--:--" onchange="handleLastRefreshChange(this)"></td>
            <td><input type="text" class="time-input default-font" value="--:--:--" onchange="handleNextRefreshChange(this)"></td>
            <td class="countdown default-font">00:00</td>
        `;
        tbody.appendChild(row);
        lastPlayedSecondsMap.set(row, -1);
        row.dataset.lastProcessedTime = 0;
    }
}

// è¯­éŸ³æ’­æ”¾å‡½æ•° - ä½¿ç”¨ç™¾åº¦API
function speak(text, isWarning = false) {
    if (isMuted) return;
    
    // ç¡®ä¿éŸ³é¢‘ä¸Šä¸‹æ–‡å¤„äºè¿è¡ŒçŠ¶æ€
    if (audioContext && audioContext.state === 'suspended') {
        audioContext.resume();
    }
    
    // æ„å»ºAPI URL
    const params = new URLSearchParams({
        ...API_PARAMS,
        tex: encodeURIComponent(text),
        per: isWarning ? 1 : 0  // 0ä¸ºæ™®é€šè¯­éŸ³ï¼Œ1ä¸ºé¢„è­¦è¯­éŸ³
    });
    
    const url = `${BAIDU_TTS_BASE_URL}?${params}`;
    
    // åˆ›å»ºéŸ³é¢‘å…ƒç´ å¹¶æ’­æ”¾
    const audio = new Audio(url);
    audio.play().catch(error => {
        console.error('è¯­éŸ³æ’­æ”¾å¤±è´¥:', error);
        // å¤±è´¥æ—¶å°è¯•æ¢å¤éŸ³é¢‘ä¸Šä¸‹æ–‡å¹¶é‡æ’­
        if (audioContext) {
            audioContext.resume().then(() => {
                audio.play().catch(e => console.error('æ¢å¤åä»æ’­æ”¾å¤±è´¥:', e));
            });
        }
    });
    
    return audio;
}

// æ·»åŠ éŸ³é¢‘æ’­æ”¾å‡½æ•° - ä½¿ç”¨Web Audio API
function playAudio(filename) {
    if (isMuted) return;
    
    // ä»æ–‡ä»¶åæå–æ•°å­—æˆ–æ ‡è¯†
    const match = filename.match(/mp3\/(\d+|yj)\.mp3/);
    if (match && match[1]) {
        const key = match[1] === 'yj' ? 'warning' : parseInt(match[1]);
        playBuffer(key);
    } else {
        // åå¤‡æ–¹æ¡ˆï¼šä½¿ç”¨ä¼ ç»ŸAudioå…ƒç´ 
        try {
            const audio = new Audio(filename);
            // å¦‚æœè¯¥éŸ³é¢‘æ­£åœ¨æ’­æ”¾ï¼Œåˆ™ä¸é‡å¤æ’­æ”¾
            if (playingAudio.has(filename)) {
                return;
            }
            playingAudio.set(filename, audio); // æ ‡è®°ä¸ºæ­£åœ¨æ’­æ”¾
            audio.play().catch(error => {
                console.error('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', error);
                if (audioContext) {
                    audioContext.resume().then(() => {
                        audio.play().catch(e => console.error('æ¢å¤åä»æ’­æ”¾å¤±è´¥:', e));
                    });
                }
            }).finally(() => {
                playingAudio.delete(filename); // æ’­æ”¾ç»“æŸåä» playingAudio ä¸­ç§»é™¤
            });
        } catch (error) {
            console.error('éŸ³é¢‘åŠ è½½é”™è¯¯:', error);
        }
    }
}

// å­˜å‚¨ç®¡ç†åŠŸèƒ½
function saveToStorage() {
    const data = {
        settings: {
            warningTime: document.getElementById('warningTime').value,
            fontSize: document.getElementById('fontSize').value,
            disableCountdownSound: document.getElementById('disableCountdownSound').checked
        },
        timers: Array.from(document.querySelectorAll('#bossTable tbody tr')).map(row => ({
            enabled: row.querySelector('input[type="checkbox"]').checked,
            mapName: row.querySelector('td:nth-child(2) input').value,
            interval: row.querySelector('td:nth-child(3) input').value,
            lastRefresh: row.querySelector('td:nth-child(4) input').value,
            nextRefresh: row.querySelector('td:nth-child(5) input').value
        }))
    };
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}

function loadFromStorage() {
    const data = JSON.parse(localStorage.getItem(STORAGE_KEY));
    if (data) {
        // æ¢å¤è®¾ç½®
        document.getElementById('warningTime').value = data.settings.warningTime || 30;
        document.getElementById('fontSize').value = data.settings.fontSize || 'default';
        document.getElementById('disableCountdownSound').checked = data.settings.disableCountdownSound || false;
        disableCountdownSound = data.settings.disableCountdownSound || false;
        
        // æ¢å¤è®¡æ—¶å™¨æ•°æ®
        const tbody = document.querySelector('#bossTable tbody');
        const rows = tbody.querySelectorAll('tr');
        
        data.timers.forEach((timer, index) => {
            if (index < rows.length) {
                const row = rows[index];
                row.querySelector('input[type="checkbox"]').checked = timer.enabled;
                row.querySelector('td:nth-child(2) input').value = timer.mapName || '';
                row.querySelector('td:nth-child(3) input').value = timer.interval || 1200;
                row.querySelector('td:nth-child(4) input').value = timer.lastRefresh || '--:--:--';
                row.querySelector('td:nth-child(5) input').value = timer.nextRefresh || '--:--:--';
                row.querySelector('.countdown').textContent = '00:00';
                row.dataset.lastProcessedTime = 0;
                
                if (timer.enabled) {
                    activeTimers.add(row);
                    updateCountdown(row);
                }
            }
        });
        
        // è¡¥å…¨Mapåˆå§‹åŒ–
        rows.forEach(row => {
            if (!lastPlayedSecondsMap.has(row)) {
                lastPlayedSecondsMap.set(row, -1);
            }
        });
    }
}

// æ—¶é—´æ¼‚ç§»æ ¡æ­£
function correctTimeDrift() {
    activeTimers.forEach(row => {
        const nextTimeInput = row.querySelector('td:nth-child(5) input');
        if (nextTimeInput.value === '--:--:--') return;
        
        updateCountdown(row);
    });
}

function handleCheckbox(checkbox) {
    const row = checkbox.closest('tr');
    const mapName = row.querySelector('td:nth-child(2) input').value;

    if (checkbox.checked) {
        speak('å¼€å§‹è®¡æ—¶');
        const now = new Date();
        const interval = parseInt(row.querySelector('td:nth-child(3) input').value) * 1000;

        // æ›´æ–°ä¸Šæ¬¡åˆ·æ–°æ—¶é—´
        const lastRefresh = formatTime(now);
        row.querySelector('td:nth-child(4) input').value = lastRefresh;

        // è®¡ç®—ä¸‹æ¬¡åˆ·æ–°æ—¶é—´
        const nextTime = new Date(now.getTime() + interval);
        row.querySelector('td:nth-child(5) input').value = formatTime(nextTime);

        // æ·»åŠ åˆ°æ´»åŠ¨è®¡æ—¶å™¨é›†åˆ
        activeTimers.add(row);
        updateCountdown(row);
    } else {
        speak('åœæ­¢è®¡æ—¶');
        row.querySelector('td:nth-child(4) input').value = '--:--:--';
        row.querySelector('td:nth-child(5) input').value = '--:--:--';
        row.querySelector('.countdown').textContent = '00:00';
        // ç§»é™¤é¢„è­¦æ ·å¼
        row.classList.remove('warning-alert');
        activeTimers.delete(row);
    }
    
    saveToStorage();
}

function formatTime(date) {
    return date.toLocaleTimeString('zh-CN', { 
        hour12: false, 
        hour: '2-digit', 
        minute: '2-digit', 
        second: '2-digit' 
    });
}

function addRow() {
    const tbody = document.querySelector('#bossTable tbody');
    const newRow = document.createElement('tr');
    const currentFont = document.getElementById('fontSize').value;
    newRow.innerHTML = `
        <td><input type="checkbox" onchange="handleCheckbox(this)" class="${currentFont}-font"></td>
        <td><input type="text" placeholder="è¾“å…¥åœ°å›¾å" class="${currentFont}-font"></td>
        <td><input type="number" value="1200" class="${currentFont}-font"></td>
        <td><input type="text" class="time-input ${currentFont}-font" value="--:--:--" onchange="handleLastRefreshChange(this)"></td>
        <td><input type="text" class="time-input ${currentFont}-font" value="--:--:--" onchange="handleNextRefreshChange(this)"></td>
        <td class="countdown ${currentFont}-font">00:00</td>
    `;
    tbody.appendChild(newRow);
    lastPlayedSecondsMap.set(newRow, -1);
    newRow.dataset.lastProcessedTime = 0;
    saveToStorage();
}

function deleteLastRow() {
    const tbody = document.querySelector('#bossTable tbody');
    if (tbody.rows.length > 1) {
        const lastRow = tbody.rows[tbody.rows.length - 1];
        activeTimers.delete(lastRow);
        lastPlayedSecondsMap.delete(lastRow);
        tbody.deleteRow(tbody.rows.length - 1);
        saveToStorage();
    } else {
        alert("è‡³å°‘ä¿ç•™ä¸€è¡Œæ•°æ®ï¼");
    }
}

// æ£€æŸ¥æ˜¯å¦éœ€è¦é¢„è­¦
function checkWarning(row) {
    const countdown = row.querySelector('.countdown').textContent;
    const mapName = row.querySelector('td:nth-child(2) input').value;
    const warningTime = parseInt(document.getElementById('warningTime').value);

    // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾é¢„è­¦æ—¶é—´ï¼ˆæ–°æ ¼å¼ï¼šMM:SSï¼‰
    const [minutes, secs] = countdown.split(':').map(Number);
    if (minutes === 0 && secs === warningTime) {
        console.log('è§¦å‘é¢„è­¦:', mapName);
        speak(`${mapName}å³å°†åˆ·æ–°`, true);
        
        // æ·»åŠ é¢„è­¦æ ·å¼
        row.classList.add('warning-alert');
        // å°†å€’è®¡æ—¶æ–‡æœ¬é¢œè‰²å’Œé˜´å½±æ”¹ä¸ºçº¢è‰²
        row.querySelector('.countdown').style.color = '#ff0000';
        row.querySelector('.countdown').style.textShadow = '0 0 8px rgba(255, 0, 0, 0.7)';
        
        // æ’­æ”¾é¢„è­¦éŸ³é¢‘
        playAudio('mp3/yj.mp3');
    } else if (minutes > 0 || secs > warningTime) { // å¦‚æœå€’è®¡æ—¶ä¸åœ¨é¢„è­¦èŒƒå›´å†…ï¼Œç¡®ä¿é¢œè‰²æ˜¯é»‘è‰²
        row.classList.remove('warning-alert');
        row.querySelector('.countdown').style.color = '#000000';
        row.querySelector('.countdown').style.textShadow = '0 0 8px rgba(0, 0, 0, 0.7)';
    }
    
    // æ£€æŸ¥å€’è®¡æ—¶æ•°å­—5-1ï¼Œæ’­æ”¾å¯¹åº”éŸ³é¢‘ï¼ˆæ–°æ ¼å¼ï¼šMM:SSï¼‰
    const currentLastSecond = lastPlayedSecondsMap.get(row) || -1;
    const seconds = parseInt(countdown.split(':')[1]); // ç°åœ¨ç§’æ•°æ˜¯ç¬¬äºŒéƒ¨åˆ†
    
    // ä½¿ç”¨æ—¶é—´æˆ³ç¡®ä¿æ¯ç§’åªå¤„ç†ä¸€æ¬¡
    const now = Date.now();
    const lastProcessed = parseInt(row.dataset.lastProcessedTime) || 0;
    
    // åªæœ‰å½“é¡µé¢æ´»è·ƒã€ç§’æ•°å˜åŒ–ä¸”åˆ†é’Ÿæ•°ä¸º0æ—¶æ‰æ’­æ”¾æ•°å­—è¯­éŸ³
    if (isPageActive && minutes === 0 && seconds >= 1 && seconds <= 5 && !disableCountdownSound && 
        seconds !== currentLastSecond) {
        
        // å…ˆæ›´æ–°çŠ¶æ€ï¼Œå†æ’­æ”¾éŸ³é¢‘ï¼Œç¡®ä¿çŠ¶æ€åŠæ—¶æ›´æ–°ä»¥é˜²æ­¢é‡å¤
        lastPlayedSecondsMap.set(row, seconds);
        playAudio(`mp3/${seconds}.mp3`);
    } else if (seconds < 1 || seconds > 5 || minutes > 0) {
        lastPlayedSecondsMap.set(row, -1);
    }
    
    // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾åˆ·æ–°æ—¶é—´ï¼ˆæ–°æ ¼å¼ï¼šMM:SSï¼‰
    if (countdown === '00:00') {
        console.log('è§¦å‘åˆ·æ–°:', mapName);
        speak(`${mapName}åˆ·æ–°`);
        
        // ç§»é™¤é¢„è­¦æ ·å¼
        row.classList.remove('warning-alert');
        // åˆ·æ–°æ—¶å°†å€’è®¡æ—¶æ–‡æœ¬é¢œè‰²å’Œé˜´å½±æ”¹å›é»‘è‰²
        row.querySelector('.countdown').style.color = '#000000';
        row.querySelector('.countdown').style.textShadow = '0 0 8px rgba(0, 0, 0, 0.7)';
        
        // æ›´æ–°åˆ·æ–°æ—¶é—´
        const now = new Date();
        const interval = parseInt(row.querySelector('td:nth-child(3) input').value) * 1000;
        const nextTime = new Date(now.getTime() + interval);
        row.querySelector('td:nth-child(5) input').value = formatTime(newTarget);
        
        // æ›´æ–°ä¸Šæ¬¡åˆ·æ–°æ—¶é—´
        row.querySelector('td:nth-child(4) input').value = formatTime(now);
        
        saveToStorage();
    }
}

// å¤„ç†ä¸Šæ¬¡åˆ·æ–°æ—¶é—´å˜åŒ–
function handleLastRefreshChange(input) {
    const row = input.closest('tr');
    const lastRefresh = input.value;
    if (lastRefresh === '--:--:--') return;

    const interval = parseInt(row.querySelector('td:nth-child(3) input').value) * 1000;

    // è®¡ç®—ä¸‹æ¬¡åˆ·æ–°æ—¶é—´
    const [h, m, s] = lastRefresh.split(':').map(Number);
    const nextTime = new Date();
    nextTime.setHours(h, m, s);
    nextTime.setTime(nextTime.getTime() + interval);

    // æ›´æ–°ä¸‹æ¬¡åˆ·æ–°æ—¶é—´
    row.querySelector('td:nth-child(5) input').value = formatTime(nextTime);

    // æ›´æ–°å€’è®¡æ—¶
    updateCountdown(row);
    saveToStorage();
}

// å¤„ç†ä¸‹æ¬¡åˆ·æ–°æ—¶é—´å˜åŒ–
function handleNextRefreshChange(input) {
    const row = input.closest('tr');
    const nextRefresh = input.value;
    if (nextRefresh === '--:--:--') return;

    const interval = parseInt(row.querySelector('td:nth-child(3) input').value) * 1000;

    // è®¡ç®—ä¸Šæ¬¡åˆ·æ–°æ—¶é—´
    const [h, m, s] = nextRefresh.split(':').map(Number);
    const lastTime = new Date();
    lastTime.setHours(h, m, s);
    lastTime.setTime(lastTime.getTime() - interval);

    // æ›´æ–°ä¸Šæ¬¡åˆ·æ–°æ—¶é—´
    row.querySelector('td:nth-child(4) input').value = formatTime(lastTime);

    // æ›´æ–°å€’è®¡æ—¶
    updateCountdown(row);
    saveToStorage();
}

// æ›´æ–°å€’è®¡æ—¶æ˜¾ç¤º
function updateCountdown(row, force = false) { // æ·»åŠ  force å‚æ•°
    // é™åˆ¶æ¯ç§’åªæ‰§è¡Œä¸€æ¬¡ï¼Œé™¤éå¼ºåˆ¶æ›´æ–°
    const currentSecond = new Date().getSeconds();
    const lastExecSecond = row.dataset.lastExecSecond || -1;
    if (!force && currentSecond === lastExecSecond) { // åªæœ‰åœ¨éå¼ºåˆ¶æ›´æ–°ä¸”ç§’æ•°æœªå˜æ—¶æ‰è·³è¿‡
        return;
    }
    row.dataset.lastExecSecond = currentSecond; // æ›´æ–°ä¸Šæ¬¡æ‰§è¡Œçš„ç§’æ•°

    const nextTimeInput = row.querySelector('td:nth-child(5) input');
    const nextTime = nextTimeInput.value;
    if (nextTime === '--:--:--') return;

    const [h, m, s] = nextTime.split(':').map(Number);
    const target = new Date();
    target.setHours(h, m, s);

    const now = new Date();
    let diff = target - now;

    // å¦‚æœæ—¶é—´å·²è¿‡ï¼Œé‡ç½®è®¡æ—¶å™¨
    if (diff < 0) {
        const interval = parseInt(row.querySelector('td:nth-child(3) input').value) * 1000;
        const newTarget = new Date(now.getTime() + interval);
        row.querySelector('td:nth-child(5) input').value = formatTime(newTarget);
        row.querySelector('td:nth-child(4) input').value = formatTime(now);
        diff = interval;
        saveToStorage();
    }

    const totalMinutes = Math.floor(diff / 60000);
    const seconds = Math.floor((diff % 60000) / 1000);
    
    row.querySelector('.countdown').textContent = 
        `${String(totalMinutes).padStart(2, '0')}:` +
        `${String(seconds).padStart(2, '0')}`;

    // å³ä½¿é¡µé¢ä¸åœ¨ç„¦ç‚¹ï¼Œä¹Ÿæ£€æŸ¥é¢„è­¦ï¼ˆè§£å†³å¤šçª—å£é—®é¢˜ï¼‰
    checkWarning(row);
}

// æ›´æ–°æ‰€æœ‰å€’è®¡æ—¶
function updateAllCountdowns(force = false) { // æ·»åŠ  force å‚æ•°
    activeTimers.forEach(row => {
        updateCountdown(row, force);
    });
}

function changeFontSize(size) {
    // ç§»é™¤æ‰€æœ‰å­—ä½“å¤§å°ç±»
    const allElements = document.querySelectorAll(
        'body, .tip, .warning-time label, .warning-time input, .font-size label, .font-size select, .countdown-sound label, .countdown-sound input, button, th, #bossTable input, #bossTable .countdown, .footer'
    );
    
    allElements.forEach(element => {
        element.classList.remove('default-font', 'medium-font', 'large-font', 'extra-large-font');
        element.classList.add(size + '-font');
    });
    
    saveToStorage();
}

// é™éŸ³åˆ‡æ¢åŠŸèƒ½
function toggleMute() {
    isMuted = !isMuted;
    localStorage.setItem('isMuted', isMuted);
    updateMuteButton();
    
    if (!isMuted) {
        // æ¿€æ´»éŸ³é¢‘ä¸Šä¸‹æ–‡
        if (audioContext && audioContext.state === 'suspended') {
            audioContext.resume();
        }
        speak('è¯­éŸ³å·²å¯ç”¨');
    }
}

// æ›´æ–°é™éŸ³æŒ‰é’®çŠ¶æ€
function updateMuteButton() {
    const btn = document.getElementById('muteBtn');
    if (isMuted) {
        btn.textContent = 'æ¢å¤è¯­éŸ³';
        btn.className = 'mute-btn ' + document.getElementById('fontSize').value + '-font';
    } else {
        btn.textContent = 'é™éŸ³æ¨¡å¼';
        btn.className = 'unmute-btn ' + document.getElementById('fontSize').value + '-font';
    }
}

// å¯¼å‡ºé…ç½®
function exportConfig() {
    saveToStorage();
    const data = localStorage.getItem(STORAGE_KEY);
    const blob = new Blob([data], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'è®¡æ—¶å™¨é…ç½®.json';
    a.click();
    URL.revokeObjectURL(url);
    speak('é…ç½®å·²å¯¼å‡º');
}

// å¯¼å…¥é…ç½®
function importConfig() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'application/json';
    input.onchange = (e) => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = (event) => {
            try {
                const data = JSON.parse(event.target.result);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
                loadFromStorage();
                speak('é…ç½®å¯¼å…¥æˆåŠŸ');
            } catch (error) {
                alert('é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼');
            }
        };
        reader.readAsText(file);
    };
    input.click();
}

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', initialize);
    </script>
<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"3JsROvHYidvkpN9A",ck:"3JsROvHYidvkpN9A"})</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"a0f86d24430442358dc52a2a28f59f57","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
